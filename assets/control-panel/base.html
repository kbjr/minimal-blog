<!doctype html>
<html lang="{{ labels.lang_code }}">
<head>
	<meta charset="UTF-8">
	<title>{{ page.title }}</title>
	<meta name="color-scheme" content="dark light">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Font imports -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://cdn.jsdelivr.net">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;1,400;1,600&display=swap">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">

	<link rel="stylesheet" href="{{{ ctrl_panel.url }}}/colors.css">
	<link rel="stylesheet" href="{{{ ctrl_panel.url }}}/styles.css">

	<!-- Expose some configuration values to client-side JS -->
	<script>
		window.conf = {
			site_url: '{{{ site.url }}}',
			ctrl_panel_url: '{{{ ctrl_panel.url }}}',
			current_page: '{{{ page.name }}}',
			post_uri_format: '{{{ feed.post_uri_format }}}',
			event_uri_format: '{{{ feed.event_uri_format }}}',
			author: {
				name: {{# feed.author_name }}'{{ feed.author_name }}' || {{/ feed.author_name }}null,
				url: {{# feed.author_url }}'{{ feed.author_url }}' || {{/ feed.author_url }}null,
				avatar: {{# feed.author_avatar }}'{{ feed.author_avatar }}' || {{/ feed.author_avatar }}null,
			}
		};
	</script>

	<script src="{{{ ctrl_panel.url }}}/app.js"></script>

	{{# page.require_auth }}
	<script src="{{{ ctrl_panel.url }}}/login_check.js"></script>
	{{/ page.require_auth}}

	<script src="{{{ ctrl_panel.url }}}/time.js" async></script>
	
	{{> page_head }}
</head>
<body id="page-{{{ page.name }}}">
	<script src="{{{ ctrl_panel.url }}}/color_theme_toggle.js"></script>
	<color-theme-toggle></color-theme-toggle>
	
	<div id="root">
		<header>
			<h2>{{ labels.control_panel }}</h2>
			<p>{{ labels.website }}: <a href="{{{ site.url }}}">{{ site.url }}</a></p>
			<p>{{ labels.control_panel }}: <a href="{{{ ctrl_panel.url }}}">{{ ctrl_panel.url }}</a></p>

			<noscript>
				<p><strong>{{ labels.noscript }}</strong></p>
			</noscript>
			
			{{# page.require_auth }}
			<nav>
				<ul>
					<!-- fixme: i18n labels for these strings -->
					<li><a href="{{{ ctrl_panel.url }}}">{{ labels.pages.dashboard.title }}</a></li>
					<li>Create New
						<ul>
							<li><a href="{{{ ctrl_panel.url }}}/posts">New Post</a></li>
							<li><a href="{{{ ctrl_panel.url }}}/posts">New Comment</a></li>
							<li><a href="{{{ ctrl_panel.url }}}/posts">New Note</a></li>
							<li><a href="{{{ ctrl_panel.url }}}/posts">New Event</a></li>
							<li><a href="{{{ ctrl_panel.url }}}/posts">New RSVP</a></li>
						</ul>
					</li>
					<li>Mentions
						<ul>
							<li><a href="">Moderation Queue</a></li>
							<li><a href="">Auto-Moderation Settings</a></li>
						</ul>
					</li>
					<li>Other Settings
						<ul>
							<li><a href="{{{ ctrl_panel.url }}}/settings">{{ labels.pages.settings.title }}</a></li>
							<li><a href="{{{ ctrl_panel.url }}}/color_themes">{{ labels.pages.color_themes.title }}</a></li>
							<li><a href="{{{ ctrl_panel.url }}}/templates">{{ labels.pages.templates.title }}</a></li>
							<li><a href="{{{ ctrl_panel.url }}}/users">{{ labels.pages.users.title }}</a></li>
						</ul>
					</li>
				</ul>
			</nav>
			
			<button id="btn-logout" onclick="void app.logout()">{{ labels.logout }}</button>
			{{/ page.require_auth }}
		</header>
		
		{{> page_content }}
	</div>

	<footer>
		<p>
			<a href="https://github.com/kbjr/minimal-blog">Minimal Blog</a>:
			Control Panel
		</p>
		<p>Version: {{ site.app_version }}</p>
	</footer>
</body>
</html>